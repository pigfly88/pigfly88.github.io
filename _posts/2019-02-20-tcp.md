---
layout: post
category: "网络"
title:  "TCP原理"
---

## TCP连接的三次握手
创建连接为什么需要三次握手呢？正常来说应该是两次就行了吧？让我们先来看一个现实生活中的例子：

亲戚给介绍了一个对象，只给了我对方的手机号，约在她家附近的公园见面。

1. 我：你在哪里？我在公园门口，我穿的是白衬衫，蓝色牛仔裤和黑色运动鞋。
2. 女神：好，我也在门口呢！我找一下看看能不能看到你，我穿的是米色连衣裙，白色高跟鞋。
1. 我：哦，我看到你了。

TCP建立连接的过程就跟上面的例子很像，双方需要相互确认，TCP的特点是保证传输可靠的，并且一般是会把数据包拆分成多个发送的，所以它还要解决包的乱序问题，我们来看看TCP建立连接的过程：

1. 客户端发起，SYN标志置位1表示这个操作是建立连接，并且设置一个初始序号seq=x（随机数）
1. 服务端收到客户端发来的建立连接的请求，同样将SYN标志置为1，ACK=x+1，并且设置一个初始序号seq=y（随机数）
1. 客户端回复ACK=y+1

正因为客户端和服务端需要互相告知自己的初始序号，所以就多了一步，这就是TCP为什么需要三次握手的原因。这个初始序号是用来解决包的乱序问题的，而且它是随机的（以防被攻击）,连接完成以后在后续的数据收发操作当中这个值会随着包的长度一直增加。

未完待续。。。