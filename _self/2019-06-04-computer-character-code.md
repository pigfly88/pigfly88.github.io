---
layout: post
category: "工具"
title:  "字符编码"
---

计算机只认识0和1，要想处理文字需要做转换，最早的一套规则是ASCII编码。

计算机一般把8个比特(bit)当做1个字节(byte)，所以，1个字节能够表示256个数字。

由于ASCII是由美国人提出的，只需要数字、英文字母和一些符号，加起来只有127个字符，所以一个字节完全够用。比如要想保存英文字母A，它在ASCII中的十进制是65，那么对应的二进制是01000001，那么计算机内部是用01000001来保存的，读取的时候再做转换，对应到ASCII的字符是A。

后来计算机开始在中国普及了，而中国的汉字常用的也得有几千个，ASCII就不够用了，怎么办，自己搞个编码规则呗，1个字节不够用就上2个字节，2个字节可以表示256*256=65536个字符。于是GB2312出来了，它收录了常用的汉字6千多个。

后来又因为一些人名和古字不在GB2312里面，又出了个GBK，它收录了两万多个汉字，其中还包括繁体字，并且兼容ASCII。

中国出了个GBK，日本、韩国等等国家也出了自己的编码，这么搞下去如果在一个文档里面包含各个国家的语言就会出现乱码，所以Unicode应运而生了。它把所有国家的编码都统一到一起。它通常用两个字节表示一个字符（如果要用到非常偏僻的字符，就需要4个字节）。

现在，捋一捋ASCII编码和Unicode编码的区别：ASCII编码是1个字节，而Unicode编码通常是2个字节。

字母A用ASCII编码是十进制的65，二进制的01000001；

字符0用ASCII编码是十进制的48，二进制的00110000，注意字符'0'和整数0是不同的；

汉字中已经超出了ASCII编码的范围，用Unicode编码是十进制的20013，二进制的01001110 00101101。

你可以猜测，如果把ASCII编码的A用Unicode编码，只需要在前面补0就可以，因此，A的Unicode编码是00000000 01000001。

需要注意的是，Unicode 只是一个符号集，它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。

互联网的普及，强烈要求出现一种统一的编码方式。UTF-8 就是在互联网上使用最广的一种 Unicode 的实现方式。其他实现方式还包括 UTF-16（字符用两个字节或四个字节表示）和 UTF-32（字符用四个字节表示），不过在互联网上基本不用。重复一遍，这里的关系是，**UTF-8 是 Unicode 的实现方式之一。**

新的问题又出现了：如果统一成Unicode编码，乱码问题从此消失了。但是，如果你写的文本基本上全部是英文的话，用Unicode编码比ASCII编码需要多一倍的存储空间，在存储和传输上就十分不划算。

所以，本着节约的精神，又出现了把Unicode编码转化为“可变长编码”的UTF-8编码。UTF-8编码把一个Unicode字符根据不同的数字大小编码成1-6个字节，常用的英文字母被编码成1个字节，汉字通常是3个字节，只有很生僻的字符才会被编码成4-6个字节。如果你要传输的文本包含大量英文字符，用UTF-8编码就能节省空间：

<table class="uk-table">
<tbody><tr><th>字符</th><th>ASCII</th><th>Unicode</th><th>UTF-8</th></tr>
<tr><td>A</td><td>01000001</td><td>00000000 01000001</td><td>01000001</td></tr>
<tr><td>中</td><td>x</td><td>01001110 00101101</td><td>11100100 10111000 10101101</td></tr>
</tbody></table>


在计算机内存中，统一使用Unicode编码，当需要保存到硬盘或者需要传输的时候，就转换为UTF-8编码。

用记事本编辑的时候，从文件读取的UTF-8字符被转换为Unicode字符到内存里，编辑完成后，保存的时候再把Unicode转换为UTF-8保存到文件：

![](/images/computer-character-1.png)

浏览网页的时候，服务器会把动态生成的Unicode内容转换为UTF-8再传输到浏览器：

![](/images/computer-character-2.png)

所以你看到很多网页的源码上会有类似<meta charset="UTF-8" />的信息，表示该网页正是用的UTF-8编码，因为用UTF-8来传输比较节省空间。

### 参考资料
- [关于字符编码，你所需要知道的](http://www.imkevinyang.com/2010/06/关于字符编码，你所需要知道的.html)
- [字符串和编码](https://www.liaoxuefeng.com/wiki/1016959663602400/1017075323632896)
- [字符编码笔记：ASCII，Unicode 和 UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)